<?xml version="1.0" encoding="UTF-8"?>
<!-- 2023/02/09 // 심규영 // 관리자 상품 xml 생성 -->
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.kmarket.dao.admin.AdminProductDAO">
    <!-- insert -->

    <insert id="insertProduct">
        INSERT INTO `km_product` SET
            prodCate1 = #{prodCate1},
            prodCate2 = #{prodCate2},
            prodName = #{prodName},
            descript = #{descript},
            company = #{company},
            seller = #{seller},
            price = #{price},
            discount = #{discount},
            `point` = #{point},
            stock = #{stock},
            delivery = #{delivery},
            thumb1 = #{thumb1},
            thumb2 = #{thumb2},
            thumb3 = #{thumb3},
            detail = #{detail},
            `status` = #{status},
            duty = #{duty},
            receipt = #{receipt},
            bizType = #{bizType},
            origin = #{origin},
            ip = #{ip},
            uid = #{uid},
            rdate = NOW();
    </insert>

    <!-- select -->
    <!-- 2023/02/09 // 심규영 // 상품 정보 가져오기 -->
    <select id="selectProduct" resultType="kr.co.kmarket.vo.productVO">
        SELECT
            `prodCate1`,
            `prodCate2`,
            `thumb1`,
            `thumb2`,
            `thumb3`,
            `detail`
        FROM `km_product`
        WHERE prodNo = #{prodNo};
    </select>

    <!-- 2023/02/09 // 심규영 // 상품들 정보 불러오기 -->
    <select id="selectProducts" resultType="kr.co.kmarket.vo.productVO">
        SELECT
            `thumb1`,
            prodNo,
            prodName,
            price,
            discount,
            `point`,
            stock,
            seller,
            hit,
            prodCate1,
            prodCate2
        FROM `km_product`
        WHERE uid LIKE #{uid} AND ${st} LIKE #{s}
        ORDER BY prodNo desc
        LIMIT #{start}, 10;
    </select>

    <select id="selectCountProduct" resultType="int">
        SELECT COUNT(prodNo) FROM km_product WHERE uid LIKE #{uid} AND ${st} LIKE #{s};
    </select>

    <!-- delete -->
    <!--
    2023/02/13 // 심규영 // 상품 삭제 기능
    상품 삭제시 자신이 올린 상품만 삭제 가능 => uid 비교
    상품 삭제시 관리자일 경우 프리패스 => uid= '%%'
    -->
    <delete id="deleteProduct">
        DELETE FROM `km_product` WHERE `prodNo` = #{prodNo} AND `uid` LIKE #{uid};
    </delete>
</mapper>